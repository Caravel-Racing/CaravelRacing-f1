
<!doctype html>
<html lang="pt-PT">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <!-- === SEO / Social / Favicon (substitui https://example.com pela tua URL real) === -->
  <title>Caravel Racing — Website</title>
  <meta name="description" content="Equipa inscrita na competição STEM Racing na temporada 2025/26 — Caravel Racing. Projetos, membros e resultados da equipa portuguesa.">

  <!-- FAVICONS: coloca estes ficheiros na raiz do site ou ajusta os caminhos -->
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">

  <!-- Canonical (substitui pela URL correta da tua homepage, ex: https://teusite.com/) -->
  <link rel="canonical" href="https://caravelracing.com/">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Caravel Racing — Website">
  <meta property="og:description" content="Equipa inscrita na competição STEM Racing na temporada 2025/26 — Caravel Racing.">
  <meta property="og:url" content="https://caravelracing.com/">
  <meta property="og:image" content="https://caravelracing.com/images/logonobg.png">
  <meta property="og:image:alt" content="Caravel Racing logo">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Caravel Racing — Website">
  <meta name="twitter:description" content="Equipa inscrita na competição STEM Racing na temporada 2025/26 — Caravel Racing.">
  <meta name="twitter:image" content="https://caravelracing.com/images/logonobg.png">

  <!-- JSON-LD structured data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "SportsTeam",
        "name": "Caravel Racing",
        "url": "https://caravelracing.com/",
        "logo": "https://caravelracing.com/images/logonobg.png",
        "description": "Equipa inscrita na competição STEM Racing na temporada 2025/26 — Caravel Racing.",
        "member": [],
        "sameAs": []
      },
      {
        "@type": "WebSite",
        "url": "https://caravelracing.com/",
        "name": "Caravel Racing — Website",
        "description": "Equipa inscrita na competição STEM Racing na temporada 2025/26 — Caravel Racing."
      }
    ]
  }
  </script>
  <!-- === fim head SEO/social === -->

  <!-- link para o teu CSS -->
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <div id="splash" class="splash-overlay" aria-hidden="false">
    <div class="splash-inner">

      <!-- GIF logo placed above title and car -->
      <div class="splash-gif-wrap" aria-hidden="true">
        <img src="images/logogifs.gif" alt="Caravel Racing animated logo" class="splash-gif">
      </div>

      <h1 class="splash-title" aria-hidden="true">
        <span class="splash-letters" id="splash-letters">

          <span class="splash-letter" data-index="0">C</span>
          <span class="splash-letter" data-index="1">A</span>
          <span class="splash-letter" data-index="2">R</span>
          <span class="splash-letter" data-index="3">A</span>
          <span class="splash-letter" data-index="4">V</span>
          <span class="splash-letter" data-index="5">E</span>
          <span class="splash-letter" data-index="6">L</span>
          <span class="splash-letter" data-index="7">&nbsp;</span>
          <span class="splash-letter" data-index="8">R</span>
          <span class="splash-letter" data-index="9">a</span>
          <span class="splash-letter" data-index="10">c</span>
          <span class="splash-letter" data-index="11">i</span>
          <span class="splash-letter" data-index="12">n</span>
          <span class="splash-letter" data-index="13">g</span>
        </span>
      </h1>

      <div class="splash-car-wrap" aria-hidden="true">
        <img class="splash-car" src="images/f1load.png" alt="F1 car" />
      </div>

      <div class="splash-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
        <div class="splash-fill" style="width:0%"></div>
      </div>

      <div class="splash-percent"><span id="splash-num">0</span>%</div>
    </div>
  </div>

  <header class="site-header">
    <div class="container">
      <img class="site-logo" src="images/logonobg.png" alt="Caravel Racing logo">

      <nav class="nav">
        <a href="index.html">Home</a>
        <a href="projects.html">Projetos</a>
        <a href="sobre-equipa.html">Sobre a Equipa</a>
        <a href="patrocinadores.html">Patrocinadores</a>
        <a href="contact.html">Contactos</a>
      </nav>

      <h1 class="brand"><span class="brand-red">CAR</span><span class="brand-avel">AVEL Racing</span></h1>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <h2>Equipa inscrita na competição STEM Racing</h2>
      <p>Home • Projetos • Sobre a Equipa • Patrocinadores • Contactos</p>
      <p><a class="btn" href="projects.html">Ver Projetos</a></p>
    </section>

    <section class="kpis">
      <div class="card"><strong>Temporada</strong><p>2025/26</p></div>
      <div class="card"><strong>Média run</strong><p>— s</p></div>
      <div class="card"><strong>Membros</strong><p>6</p></div>
    </section>

    <section class="projects-preview">
      <div class="grid">
        <article class="project-card">
          <h4>Caravel V1 — 2025/26</h4>
          <p>Primeiro esboço</p>
          <p><a href="projects/caravel-v1-2025.html" class="btn small">Ver Projeto</a></p>
        </article>
      </div>
    </section>

  </main>

  <footer class="site-footer">
    <div class="container">
      <p>© Caravel Racing — Portugal</p>
    </div>
  </footer>

  <!-- === SCRIPTS === -->
  <script>
  (function(){
    const splash = document.getElementById('splash');
    if (!splash) return;

    const splashInner = splash.querySelector('.splash-inner');
    const splashBar   = splash.querySelector('.splash-bar');
    const fill        = splash.querySelector('.splash-fill');
    const num         = document.getElementById('splash-num');
    const car         = splash.querySelector('.splash-car'); 
    const lettersWrap = document.getElementById('splash-letters');

    (function groupLettersIntoWords(){
      if (!lettersWrap) return;
      const letterNodes = Array.from(lettersWrap.querySelectorAll('.splash-letter'));
      if (!letterNodes.length) return;

      const frag = document.createDocumentFragment();
      let word = document.createElement('span');
      word.className = 'splash-word';

      letterNodes.forEach((ln) => {
        const text = (ln.textContent || '').replace(/\u00A0/g, ' ').trim();
        if (text === '') {
          if (word.childNodes.length) {
            frag.appendChild(word);
            word = document.createElement('span');
            word.className = 'splash-word';
          }

          const spacer = document.createElement('span');
          spacer.className = 'splash-letter splash-space';
          spacer.innerHTML = '&nbsp;';
          frag.appendChild(spacer);
        } else {
          word.appendChild(ln);
        }
      });

      if (word.childNodes.length) frag.appendChild(word);
      lettersWrap.innerHTML = '';
      lettersWrap.appendChild(frag);
    })();


    const letters = lettersWrap ? Array.from(lettersWrap.querySelectorAll('.splash-letter')) : [];

    const splashGifWrap = splash.querySelector('.splash-gif-wrap');
    const splashGif = splash.querySelector('.splash-gif');

    // CONFIG
    const totalMs = 4500;      
    const safetyExtra = 3000; 

    let progress = 0;
    let running = true;
    let minTimeReached = false;
    let pageLoaded = false;

    document.documentElement.classList.add('splash-active');
    document.body.classList.add('splash-active');

    const stepDelay = Math.max(20, Math.round(totalMs / 99));

    function updateCar(pct) {
      if (!car || !splashBar || !splashInner) return;

      const innerRect = splashInner.getBoundingClientRect();
      const barRect   = splashBar.getBoundingClientRect();
      const carRect   = car.getBoundingClientRect();

      const barOffset = barRect.left - innerRect.left;

      const xCenter = barOffset + (pct / 100) * barRect.width;

      const leftPx = xCenter - (carRect.width / 2);

      const clamped = Math.max(0, Math.min(leftPx, innerRect.width - carRect.width));
      car.style.left = clamped + 'px';
    }

    function updateLetters(pct){
      if (!letters || !letters.length) return;
      const total = letters.length;
      const pos = (pct / 100) * total;
      for(let i=0;i<total;i++){
        const el = letters[i];
        const idx = i + 1;
        if (idx <= Math.floor(pos)){
          el.style.opacity = '1';
          el.style.transform = 'translateY(0) scale(1)';
        } else if (idx === Math.floor(pos) + 1){
          const partial = Math.max(0, Math.min(1, pos - Math.floor(pos)));
          el.style.opacity = String(partial);
          const y = (1 - partial) * 8; 
          const s = 0.98 + (partial * 0.02);
          el.style.transform = `translateY(${y}px) scale(${s})`;
        } else {
          el.style.opacity = '0';
          el.style.transform = 'translateY(8px) scale(0.98)';
        }
      }
    }

    function ensureCarReadyAndUpdate() {
      if (!car) return updateCar(progress);

      if (car.tagName === 'IMG') {
        if (!car.complete) {
          car.addEventListener('load', () => updateCar(progress), { once: true });
          car.addEventListener('error', () => updateCar(progress), { once: true });
        } else {
          updateCar(progress);
        }
      } else {
        updateCar(progress);
      }
    }

    let interval = setInterval(() => {
      if (!running) { clearInterval(interval); return; }
      if (progress < 99) {
        progress += 1;
        fill.style.width = progress + '%';
        num.textContent = progress;
        updateCar(progress);
        updateLetters(progress);
      } else {
        clearInterval(interval);
      }
    }, stepDelay);

    function finishNow() {
      if (!running) return;
      running = false;
      clearInterval(interval);
      progress = 100;
      fill.style.width = '100%';
      num.textContent = '100';
      updateCar(100);
      updateLetters(100);
      setTimeout(() => {
        splash.classList.add('hidden');
        splash.addEventListener('transitionend', () => {
          if (splash && splash.parentNode) splash.parentNode.removeChild(splash);
        }, { once: true });
        document.documentElement.classList.remove('splash-active');
        document.body.classList.remove('splash-active');
      }, 300);
    }

    setTimeout(() => {
      minTimeReached = true;
      if (pageLoaded) finishNow();
    }, totalMs);

    window.addEventListener('load', () => {
      pageLoaded = true;
      if (minTimeReached) finishNow();
    });

    setTimeout(() => {
      if (running) finishNow();
    }, totalMs + safetyExtra);

    window.addEventListener('resize', () => {
      setTimeout(() => ensureCarReadyAndUpdate(), 60);
    });

    setTimeout(() => ensureCarReadyAndUpdate(), 20);

    function restartGif() {
      if (!splashGif || !splashGif.parentNode) return;
      const src = (splashGif.getAttribute('src') || '').split('?')[0];
      const newGif = document.createElement('img');

      newGif.className = splashGif.className;
      newGif.alt = splashGif.alt || '';
      newGif.setAttribute('aria-hidden', 'true');
      newGif.style.pointerEvents = 'none';

      newGif.src = src + '?_=' + Date.now();

      newGif.addEventListener('load', () => {
        if (splashGif.parentNode) splashGif.parentNode.replaceChild(newGif, splashGif);
      }, { once: true });
      setTimeout(() => {
        if (splashGif.parentNode) splashGif.parentNode.replaceChild(newGif, splashGif);
      }, 250);
    }

    restartGif();

    window.addEventListener('pageshow', (ev) => {
      restartGif();
    });

    document.addEventListener('visibilitychange', () => {
      if (document.visibilityState === 'visible') restartGif();
    });

  })();
  </script>
</body>
</html>
