<!doctype html>
<html lang="pt-PT">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Caravel Racing — Website</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<script>
(function() {
  // Tenta ler a duração do CSS (variável --splash-duration em segundos)
  const rootStyles = getComputedStyle(document.documentElement);
  const cssDur = rootStyles.getPropertyValue('--splash-duration').trim();
  let DURATION = 4500; // fallback ms
  if (cssDur) {
    // aceita formatos '4.5s' ou '4500ms' ou apenas '4.5'
    if (cssDur.endsWith('ms')) {
      DURATION = parseFloat(cssDur);
    } else if (cssDur.endsWith('s')) {
      DURATION = parseFloat(cssDur) * 1000;
    } else {
      const n = parseFloat(cssDur);
      if (!isNaN(n)) DURATION = (n > 10 ? n : n * 1000); // heurística
    }
  }

  const progressText = document.getElementById('progressText');
  const progressBar = document.getElementById('progressBar');
  const splash = document.getElementById('splash');

  // proteções básicas
  if (!progressText || !progressBar || !splash) return;

  // bloquear scroll enquanto splash está activo
  document.body.classList.add('no-scroll');

  // respeitar preferência do utilizador por pouca animação
  const reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  if (reduce) {
    setFinalState();
    return;
  }

  let startTime = null;
  function step(ts) {
    if (!startTime) startTime = ts;
    const elapsed = ts - startTime;
    const pct = Math.min(1, elapsed / DURATION);
    const value = Math.floor(pct * 100); // usar floor para evitar 100 antes do fim visual
    progressText.textContent = value + '%';
    progressBar.style.width = (value) + '%';

    if (elapsed < DURATION) {
      window.requestAnimationFrame(step);
    } else {
      // garante 100% no fim (evita arredondamento)
      progressText.textContent = '100%';
      progressBar.style.width = '100%';
      endSplashSoon();
    }
  }

  window.requestAnimationFrame(step);

  function endSplashSoon() {
    splash.classList.add('splash-hidden');
    setTimeout(() => {
      splash.style.display = 'none';
      splash.setAttribute('aria-hidden', 'true');
      document.body.classList.remove('no-scroll');
      // limpar variáveis para GC
      startTime = null;
    }, 600);
  }

  function setFinalState() {
    progressText.textContent = '100%';
    progressBar.style.width = '100%';
    // pequeno tempo até esconder
    setTimeout(endSplashSoon, 300);
  }
})();
</script>


<body>
  
<!-- SPLASH / INTRO FULLSCREEN -->
<div id="splash" aria-hidden="false">
  <div class="splash-content" role="dialog" aria-label="Animação de entrada">
    <h1 class="splash-brand">Caravel Racing</h1>

    <div class="track" aria-hidden="true">
      <div class="car" id="car"></div>
    </div>

    <div class="progress-wrap" aria-hidden="true">
      <div class="progress-bar" id="progressBar"></div>
      <div class="progress-text" id="progressText">0%</div>
    </div>
  </div>
</div>



  <header class="site-header">
    <div class="container">
      <h1 class="brand"><span style="color: red; text-transform: uppercase;">CAR</span>AVEL Racing</h1>
      <nav class="nav">
        <a href="index.html">Home</a>
        <a href="projects.html">Projetos</a>
        <a href="sobre-equipa.html">Sobre a Equipa</a>
        <a href="patrocinadores.html">Patrocinadores</a>
        <a href="contact.html">Contactos</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <h2>Equipa portuguesa inscrita na competição 'STEM Racing'</h2>
      <p>ns • ns • ns • ns • ns</p>
      <p><a class="btn" href="projects.html">Ver Projetos</a></p>
    </section>

    <section class="kpis">
      <div class="card"><strong>Temporada</strong><p>2025/26</p></div>
      <div class="card"><strong>Média run</strong><p>— s</p></div>
      <div class="card"><strong>Membros</strong><p>6</p></div>
    </section>

    <section class="projects-preview">
      <div class="grid">
        <article class="project-card">
          <h4>Caravel V1 — 2025/26</h4>
          <p>Primeiro esboço</p>
          <p><a href="projects/caravel-v1-2025.html" class="btn small">Ver Projeto</a></p>
        </article>
      </div>
    </section>

  </main>

  <footer class="site-footer">
    <div class="container">
      <p>© Caravel Racing — Portugal</p>
    </div>
  </footer>
</body>
</html>
